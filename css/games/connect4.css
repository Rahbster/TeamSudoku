/*==============================
  Connect 4 Game Styles
==============================*/

/* New layout container for Connect 4 to make the grid larger */
#connect4-layout-container {
    display: grid; /* Use CSS Grid for robust layout */
    grid-template-rows: auto 1fr; /* Top bar takes its content height, grid takes the rest */
    width: 100%;
    padding: 1rem;
    box-sizing: border-box;
    gap: 1rem;
}

/* New container for the top controls */
#connect4-top-bar {
    display: flex;
    justify-content: space-between; /* Pushes timer to left, undo to right */
    align-items: stretch; /* Make children the same height */
    width: 100%;
    gap: 1rem;
}

/* Center the Undo button within its flex space */
#connect4-top-bar #connect4-undo-btn {
    margin: 0 auto; /* This centers the button between the timer and the edge */
}

/* When Connect 4 is active, ensure its layout container fills the game board area */
body.connect4-active #game-board-area {
    align-items: stretch; /* Make the child container fill the height */
    justify-content: stretch; /* Make the child container fill the width */
    flex-grow: 1;
}


/* The undo button will be centered at the bottom by default due to align-items: center */

.connect4-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    grid-template-rows: repeat(6, 1fr);
    background-color: #007bff; /* Classic blue board color */
    border: 10px solid #0056b3;
    border-radius: 10px;
    gap: 10px;
    aspect-ratio: 7 / 6;
}

.connect4-grid .grid-cell {
    border-radius: 50%;
    background-color: #ffffff;
    border: 4px solid #0056b3;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

.connect4-grid .grid-cell:hover {
    background-color: #e0e0e0;
}

.connect4-grid .grid-cell.player1 {
    background-color: #ffc107; /* Yellow player */
    border-color: #d39e00;
}

.connect4-grid .grid-cell.player2 {
    background-color: #dc3545; /* Red player */
    border-color: #b02a37;
}

.connect4-grid .grid-cell.winning-cell-blink {
    animation: connect4-blink 1s steps(1) 3; /* Blink 3 times */
}

@keyframes connect4-blink {
    0%, 100% {
        transform: scale(1);
    }
    50% {
        transform: scale(1.15);
        box-shadow: 0 0 15px 5px #fff;
    }
}

/* Wrapper for the Connect 4 grid to contain the thinking indicator */
#connect4-grid-wrapper {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    height: 100%;
    min-height: 0; /* Important for flexbox children in a grid layout */
}

/* The actual grid inside the wrapper should grow to fill it */
#connect4-grid-wrapper > .connect4-grid {
    width: auto; /* Allow width to be determined by height and aspect-ratio */
    height: 100%;
    max-width: 100%; /* Don't overflow the container */
}

/* Style for the AI thinking indicator overlay */
#ai-thinking-indicator {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: rgba(0, 0, 0, 0.75);
    color: white;
    padding: 20px 40px;
    border-radius: 10px;
    font-size: 2rem;
    font-weight: bold;
    z-index: 100; /* Make sure it's on top of the grid */
    pointer-events: none; /* Don't block clicks */
}

/* Style for the AI score display to be an overlay */
.ai-score-display {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 1rem;
    font-weight: bold;
    color: black;
    background-color: rgba(255, 255, 255, 0.7);
    padding: 2px 5px;
    border-radius: 3px;
    pointer-events: none; /* Make sure it doesn't block clicks */
}

.connect4-grid .grid-cell.imminent-victory-cell {
    animation: victory-pulse 1.5s infinite;
}

.connect4-grid .grid-cell.imminent-defeat-cell {
    animation: defeat-pulse 1.5s infinite;
}

@keyframes victory-pulse {
    0%, 100% {
        box-shadow: 0 0 10px 2px rgba(255, 255, 0, 0.7); /* Yellow glow */
    }
    50% {
        box-shadow: 0 0 20px 8px rgba(255, 255, 0, 0.3);
    }
}

@keyframes defeat-pulse {
    0%, 100% {
        box-shadow: 0 0 10px 2px rgba(255, 0, 0, 0.7); /* Red glow */
    }
    50% {
        box-shadow: 0 0 20px 8px rgba(255, 0, 0, 0.3);
    }
}

/* Default Theme for Connect 4 */
body.default .connect4-grid {
    background-color: #8B4513; /* SaddleBrown */
    border-color: #5E2C04;
}
body.default .connect4-grid .grid-cell {
    background-color: #F5DEB3; /* Wheat */
    border-color: #8B4513;
}
body.default .connect4-grid .grid-cell.player1 {
    background-color: #d9534f; /* Red */
    border-color: #b52b27;
}
body.default .connect4-grid .grid-cell.player2 {
    background-color: #f0ad4e; /* Yellow */
    border-color: #df8a13;
}

/* Dark Mode Theme for Connect 4 */
body.dark-mode .connect4-grid {
    background-color: #2c3e50; /* Dark Slate Blue */
    border-color: #1a252f;
}
body.dark-mode .connect4-grid .grid-cell {
    background-color: #7f8c8d; /* Grayish */
    border-color: #2c3e50;
}
body.dark-mode .connect4-grid .grid-cell.player1 {
    background-color: #1abc9c; /* Teal */
    border-color: #16a085;
}
body.dark-mode .connect4-grid .grid-cell.player2 {
    background-color: #e74c3c; /* Red */
    border-color: #c0392b;
}

/* Banished Theme for Connect 4 */
body.banished .connect4-grid {
    background-color: #4A4549; /* Banished Grey */
    border-color: #262125;
}
body.banished .connect4-grid .grid-cell {
    background-color: #6B686A;
    border-color: #4A4549;
}
body.banished .connect4-grid .grid-cell.player1 {
    background-color: #C22D2D; /* Banished Red */
    border-color: #8C2F2F;
}
body.banished .connect4-grid .grid-cell.player2 {
    background-color: #E0DEDF; /* Banished Silver/White */
    border-color: #A3A0A2;
}

/* UNSC Theme for Connect 4 */
body.unsc .connect4-grid {
    background-color: #1D3A2F; /* UNSC Dark Green */
    border-color: #1A1A1A;
}
body.unsc .connect4-grid .grid-cell {
    background-color: #4C4A45; /* UNSC Grey */
    border-color: #1D3A2F;
}
body.unsc .connect4-grid .grid-cell.player1 {
    background-color: #EFB82A; /* UNSC Gold */
    border-color: #b38600;
}
body.unsc .connect4-grid .grid-cell.player2 {
    background-color: #00A0C0; /* Forerunner Cyan as accent */
    border-color: #007a99;
}

/* Forerunner Theme for Connect 4 */
body.forerunner .connect4-grid {
    background-color: #3A5A7A; /* Forerunner Blue/Grey */
    border-color: #1A2A3A;
}
body.forerunner .connect4-grid .grid-cell {
    background-color: #C0D0E0; /* Light metal */
    border-color: #3A5A7A;
}
body.forerunner .connect4-grid .grid-cell.player1 {
    background-color: var(--primary-cyan);
    border-color: #007a99;
}
body.forerunner .connect4-grid .grid-cell.player2 {
    background-color: var(--secondary-orange);
    border-color: #c88b00;
}